tinymce.PluginManager.add("icmsinsertfile",function(l,i){if(!l.settings.file_upload.url)return!1;var r={form_id:"icmsinsertfile_form",action:"",inputs:{file:{id:"inline_upload_file",name:"inline_upload_file"}},submit:{id:"inline_upload_submit",value:""},iframe:"inline_upload_iframe"};return l.settings.file_picker_callback=file_picker_callback=function(i,e,t){var n,a;n=i,a=t,0===$("#"+r.form_id).length?($(['<div><form id="',r.form_id,'" action="',l.settings.file_upload.url+"&filetype="+a.filetype,'" target="',r.iframe,'" method="post" enctype="multipart/form-data">','<input name="',r.inputs.file.name,'" id="',r.inputs.file.id,'" type="file" /><input id="',r.submit.id,'" type="button" value="',r.submit.value,'" /></form><iframe id="',r.iframe,'" name="',r.iframe,'" src="about:blank" style="height:0;display: block;"></iframe></div>'].join("")).hide().appendTo("body"),$("#"+r.inputs.file.id).on("change",function(){$("#"+r.form_id).submit()}),$("#"+r.iframe).on("load",function(){$("#"+r.inputs.file.id).val("");var i=$(this).contents().find("pre").text();if(i||(i=$(this).contents().text()),!i)return!1;var e=JSON.parse(i);e.success?n(e.location,{text:e.name}):tinymce.activeEditor.windowManager.alert(e.error)})):$("#"+r.form_id).attr("action",l.settings.file_upload.url+"&filetype="+a.filetype),$("#"+r.inputs.file.id).trigger("click")},{getMetadata:function(){return{name:"File upload plugin",url:"https://instantcms.ru/"}}}});